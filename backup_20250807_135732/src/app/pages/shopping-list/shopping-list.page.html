<ion-header>
  <ion-toolbar color="dark">
    <ion-title>Lista de Compras</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="generateShoppingList()">
        <ion-icon name="refresh"></ion-icon>
      </ion-button>
      <ion-button (click)="clearPurchased()">
        <ion-icon name="trash"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content color="dark">
  <ion-segment [(ngModel)]="selectedCategory" color="primary">
    <ion-segment-button value="all">
      <ion-label>Todos</ion-label>
    </ion-segment-button>
    <ion-segment-button *ngFor="let cat of categories" [value]="cat">
      <ion-label>{{ cat }}</ion-label>
    </ion-segment-button>
  </ion-segment>

  <ion-list>
    <ion-item *ngFor="let item of shoppingList"
              [hidden]="selectedCategory !== 'all' && item.category !== selectedCategory"
              color="dark"
              [class.purchased]="item.purchased">
      <ion-checkbox [(ngModel)]="item.purchased" (ionChange)="markAsPurchased(item)"></ion-checkbox>
      <ion-label>
        <h2>{{ item.name }}</h2>
        <p>{{ item.quantity }} {{ item.unit }} - R$ {{ item.estimatedCost.toFixed(2) }}</p>
      </ion-label>
      <ion-note slot="end" color="primary">{{ item.category }}</ion-note>
    </ion-item>
  </ion-list>

  <div class="total-section">
    <h2>Total Estimado:</h2>
    <h1>R$ {{ totalCost.toFixed(2) }}</h1>
  </div>
</ion-content>
